<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An image loading library designed for Compose Multiplatform and Android View. It is powerful and rich in functions. In addition to basic functions, it also supports GIF, SVG, video thumbnails, Exif Orientation, etc."><meta name=author content="2024 panpf"><link href=https://github.com/panpf/sketch/zh/ rel=canonical><link href=getting_started/ rel=next><link rel=icon href=../images/logo.ico><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.16"><title>Overview - Sketch Image Loader</title><link rel=stylesheet href=../assets/stylesheets/main.7e37652d.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=JetBrains:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"JetBrains";--md-code-font:"JetBrains Mono"}</style><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#sketch-image-loader class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=页眉> <a href=./ title="Sketch Image Loader" class="md-header__button md-logo" aria-label="Sketch Image Loader" data-md-component=logo> <img src=../images/logo.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Sketch Image Loader </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Overview </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media=(prefers-color-scheme) data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=white data-md-color-accent=white aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=black data-md-color-accent=black aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <div class=md-header__option> <div class=md-select> <button class="md-header__button md-icon" aria-label=选择当前语言> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg> </button> <div class=md-select__inner> <ul class=md-select__list> <li class=md-select__item> <a href=/panpf/sketch/ hreflang=en class=md-select__link> English </a> </li> <li class=md-select__item> <a href=/panpf/sketch/zh/ hreflang=zh class=md-select__link> 中文 </a> </li> </ul> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=查找> <a href=javascript:void(0) class="md-search__icon md-icon" title=分享 aria-label=分享 data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=清空当前内容 aria-label=清空当前内容 tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/panpf/sketch title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> Sketch </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=导航栏 data-md-level=0> <label class=md-nav__title for=__drawer> <a href=./ title="Sketch Image Loader" class="md-nav__button md-logo" aria-label="Sketch Image Loader" data-md-component=logo> <img src=../images/logo.png alt=logo> </a> Sketch Image Loader </label> <div class=md-nav__source> <a href=https://github.com/panpf/sketch title=前往仓库 class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> Sketch </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Overview </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Overview </span> </a> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#app class=md-nav__link> <span class=md-ellipsis> 示例 App </span> </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 安装 </span> </a> <nav class=md-nav aria-label=安装> <ul class=md-nav__list> <li class=md-nav__item> <a href=#compose-multiplatform class=md-nav__link> <span class=md-ellipsis> Compose Multiplatform: </span> </a> </li> <li class=md-nav__item> <a href=#android-view class=md-nav__link> <span class=md-ellipsis> Android View: </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 可选模块 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 注册组件 </span> </a> </li> <li class=md-nav__item> <a href=#r8-proguard class=md-nav__link> <span class=md-ellipsis> R8 / Proguard </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 快速上手 </span> </a> <nav class=md-nav aria-label=快速上手> <ul class=md-nav__list> <li class=md-nav__item> <a href=#compose-multiplatform_1 class=md-nav__link> <span class=md-ellipsis> Compose Multiplatform： </span> </a> </li> <li class=md-nav__item> <a href=#android-view_1 class=md-nav__link> <span class=md-ellipsis> Android View： </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 文档 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 更新日志 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 测试平台 </span> </a> </li> <li class=md-nav__item> <a href=#app_1 class=md-nav__link> <span class=md-ellipsis> 运行示例 App </span> </a> </li> <li class=md-nav__item> <a href=#40 class=md-nav__link> <span class=md-ellipsis> 关于 4.0 版本 </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 特别感谢 </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 我的项目 </span> </a> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=getting_started/ class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> </li> <li class=md-nav__item> <a href=register_component/ class=md-nav__link> <span class=md-ellipsis> Register Component </span> </a> </li> <li class=md-nav__item> <a href=compose/ class=md-nav__link> <span class=md-ellipsis> Compose </span> </a> </li> <li class=md-nav__item> <a href=http/ class=md-nav__link> <span class=md-ellipsis> Http </span> </a> </li> <li class=md-nav__item> <a href=animated_image/ class=md-nav__link> <span class=md-ellipsis> Animated Image </span> </a> </li> <li class=md-nav__item> <a href=resize/ class=md-nav__link> <span class=md-ellipsis> Resize </span> </a> </li> <li class=md-nav__item> <a href=transformation/ class=md-nav__link> <span class=md-ellipsis> Transformation </span> </a> </li> <li class=md-nav__item> <a href=transition/ class=md-nav__link> <span class=md-ellipsis> Transition </span> </a> </li> <li class=md-nav__item> <a href=state_image/ class=md-nav__link> <span class=md-ellipsis> StateImage </span> </a> </li> <li class=md-nav__item> <a href=listener/ class=md-nav__link> <span class=md-ellipsis> Listener </span> </a> </li> <li class=md-nav__item> <a href=download_cache/ class=md-nav__link> <span class=md-ellipsis> DownloadCache </span> </a> </li> <li class=md-nav__item> <a href=result_cache/ class=md-nav__link> <span class=md-ellipsis> ResultCache </span> </a> </li> <li class=md-nav__item> <a href=memory_cache/ class=md-nav__link> <span class=md-ellipsis> MemoryCache </span> </a> </li> <li class=md-nav__item> <a href=fetcher/ class=md-nav__link> <span class=md-ellipsis> Fetcher </span> </a> </li> <li class=md-nav__item> <a href=decoder/ class=md-nav__link> <span class=md-ellipsis> Decoder </span> </a> </li> <li class=md-nav__item> <a href=target/ class=md-nav__link> <span class=md-ellipsis> Target </span> </a> </li> <li class=md-nav__item> <a href=svg/ class=md-nav__link> <span class=md-ellipsis> SVG </span> </a> </li> <li class=md-nav__item> <a href=video_frame/ class=md-nav__link> <span class=md-ellipsis> Video Frames </span> </a> </li> <li class=md-nav__item> <a href=blurhash/ class=md-nav__link> <span class=md-ellipsis> BlurHash </span> </a> </li> <li class=md-nav__item> <a href=exif_orientation/ class=md-nav__link> <span class=md-ellipsis> Exif Orientation </span> </a> </li> <li class=md-nav__item> <a href=image_options/ class=md-nav__link> <span class=md-ellipsis> ImageOptions </span> </a> </li> <li class=md-nav__item> <a href=request_interceptor/ class=md-nav__link> <span class=md-ellipsis> RequestInterceptor </span> </a> </li> <li class=md-nav__item> <a href=decode_interceptor/ class=md-nav__link> <span class=md-ellipsis> DecodeInterceptor </span> </a> </li> <li class=md-nav__item> <a href=preload/ class=md-nav__link> <span class=md-ellipsis> Preload </span> </a> </li> <li class=md-nav__item> <a href=download_image/ class=md-nav__link> <span class=md-ellipsis> Download Image </span> </a> </li> <li class=md-nav__item> <a href=lifecycle/ class=md-nav__link> <span class=md-ellipsis> Lifecycle </span> </a> </li> <li class=md-nav__item> <a href=sketch_image_view/ class=md-nav__link> <span class=md-ellipsis> SketchImageView </span> </a> </li> <li class=md-nav__item> <a href=long_image_grid_thumbnails/ class=md-nav__link> <span class=md-ellipsis> Clearer Thumbnail </span> </a> </li> <li class=md-nav__item> <a href=progress_indicator/ class=md-nav__link> <span class=md-ellipsis> Progress Indicator </span> </a> </li> <li class=md-nav__item> <a href=mime_type_logo/ class=md-nav__link> <span class=md-ellipsis> Mime Type Logo </span> </a> </li> <li class=md-nav__item> <a href=save_cellular_traffic/ class=md-nav__link> <span class=md-ellipsis> Save Cellular Data </span> </a> </li> <li class=md-nav__item> <a href=pause_load_when_scrolling/ class=md-nav__link> <span class=md-ellipsis> Pause Load When Scrolling </span> </a> </li> <li class=md-nav__item> <a href=apk_app_icon/ class=md-nav__link> <span class=md-ellipsis> Apk/App Icon </span> </a> </li> <li class=md-nav__item> <a href=log/ class=md-nav__link> <span class=md-ellipsis> Log </span> </a> </li> <li class=md-nav__item> <a href=migrate/ class=md-nav__link> <span class=md-ellipsis> Migrate </span> </a> </li> <li class=md-nav__item> <a href=CHANGELOG/ class=md-nav__link> <span class=md-ellipsis> Change Log </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#app class=md-nav__link> <span class=md-ellipsis> 示例 App </span> </a> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> <span class=md-ellipsis> 安装 </span> </a> <nav class=md-nav aria-label=安装> <ul class=md-nav__list> <li class=md-nav__item> <a href=#compose-multiplatform class=md-nav__link> <span class=md-ellipsis> Compose Multiplatform: </span> </a> </li> <li class=md-nav__item> <a href=#android-view class=md-nav__link> <span class=md-ellipsis> Android View: </span> </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> <span class=md-ellipsis> 可选模块 </span> </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> <span class=md-ellipsis> 注册组件 </span> </a> </li> <li class=md-nav__item> <a href=#r8-proguard class=md-nav__link> <span class=md-ellipsis> R8 / Proguard </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> <span class=md-ellipsis> 快速上手 </span> </a> <nav class=md-nav aria-label=快速上手> <ul class=md-nav__list> <li class=md-nav__item> <a href=#compose-multiplatform_1 class=md-nav__link> <span class=md-ellipsis> Compose Multiplatform： </span> </a> </li> <li class=md-nav__item> <a href=#android-view_1 class=md-nav__link> <span class=md-ellipsis> Android View： </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> <span class=md-ellipsis> 文档 </span> </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> <span class=md-ellipsis> 更新日志 </span> </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> <span class=md-ellipsis> 测试平台 </span> </a> </li> <li class=md-nav__item> <a href=#app_1 class=md-nav__link> <span class=md-ellipsis> 运行示例 App </span> </a> </li> <li class=md-nav__item> <a href=#40 class=md-nav__link> <span class=md-ellipsis> 关于 4.0 版本 </span> </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> <span class=md-ellipsis> 特别感谢 </span> </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> <span class=md-ellipsis> 我的项目 </span> </a> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=sketch-image-loader><img alt=logo_image src=../images/logo.png> Sketch Image Loader<a class=headerlink href=#sketch-image-loader title="Permanent link">&para;</a></h1> <p><img alt=Platform src=https://img.shields.io/badge/Platform-ComposeMultiplatform-brightgreen.svg> [<img alt=License src=https://img.shields.io/badge/License-Apache%202-blue.svg>]<a href=https://www.apache.org/licenses/LICENSE-2.0>license_link</a> [<img alt=version_icon src=https://img.shields.io/maven-central/v/io.github.panpf.sketch4/sketch-singleton>]<a href=https://repo1.maven.org/maven2/io/github/panpf/sketch4/ >version_link</a> <img alt="QQ Group" src=https://img.shields.io/badge/QQ%E4%BA%A4%E6%B5%81%E7%BE%A4-529630740-red.svg></p> <p>翻译：<a href=./ >English</a></p> <p>Sketch 是专为 Compose Multiplatform 和 Android View 设计的图片加载库，它有以下特点：</p> <ul> <li><code>多加载源</code>：支持从 http、file、compose resource、android asset/content/resource 等多种来源加载图片</li> <li><code>功能强大</code>：支持三级缓存、自动取消请求、自动调整图片尺寸、自动根据 Exif Orientation 旋转图片等</li> <li><code>功能丰富</code>：支持动图、SVG 图片、Base64 图片、视频帧</li> <li><code>易于扩展</code>：支持对缓存、解码、转换、过渡、占位图等各个环节的扩展</li> <li><code>扩展功能</code>：提供蜂窝流量时暂停下载、列表滚动中暂停加载、图片类型徽章、下载进度指示器等实用扩展</li> <li><code>现代化</code>：完全基于 Kotlin 和 Kotlin 协程设计</li> </ul> <h2 id=app>示例 App<a class=headerlink href=#app title="Permanent link">&para;</a></h2> <ul> <li>Android、iOS、桌面版、Web 可部署包请到 <a href=https://github.com/panpf/sketch/releases>Releases</a> 页面下载最新版本</li> <li>Web 示例：https://panpf.github.io/sketch/app</li> </ul> <h2 id=_1>安装<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <p><code>已发布到 mavenCentral</code></p> <p><code>${LAST_VERSION}</code>: <a href=https://repo1.maven.org/maven2/io/github/panpf/sketch4/ ><img alt=Download src=https://img.shields.io/maven-central/v/io.github.panpf.sketch4/sketch-singleton></a> (不包含 'v')</p> <h3 id=compose-multiplatform>Compose Multiplatform:<a class=headerlink href=#compose-multiplatform title="Permanent link">&para;</a></h3> <p>导入必需的 Compose 和网络模块：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1>// 提供了 Sketch 的核心功能以及单例和依赖单例实现的扩展函数</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-compose:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=c1>// 提供了加载网络图片的能力</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-http:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
</code></pre></div> <blockquote> <p>[!IMPORTANT] 为提升 compose 的性能请拷贝 <code>sketch-core</code> 模块下的 <a href=https://github.com/panpf/sketch/blob/main/sketch-core/compose_compiler_config.conf>compose_compiler_config.conf</a> 文件到您的项目中，然后按照 <a href=https://developer.android.com/develop/ui/compose/performance/stability/fix#configuration-file>Compose Stability Configuration</a> 文档配置它</p> </blockquote> <h3 id=android-view>Android View:<a class=headerlink href=#android-view title="Permanent link">&para;</a></h3> <p>导入必需的 View 和网络模块：</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1>// 提供了 Sketch 的核心功能以及单例和依赖单例实现的扩展函数</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-view:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=c1>// 提供了加载网络图片的能力</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-http:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
</code></pre></div> <h3 id=_2>可选模块<a class=headerlink href=#_2 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1>// 使用 Android 或 Skia 内置的解码器解码 gif 动图并播放</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-animated-gif:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=c1>// [仅 Android] 使用 android-gif-drawable 库的 GifDrawable 解码 gif 动图并播放</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-animated-gif-koral:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=c1>// [仅 Android] Android 或 Skia 内置的解码器解码 heif 动图并播放</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-animated-heif:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=c1>// 使用 Android 或 Skia 内置的解码器解码 webp 动图并播放</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-animated-webp:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=c1>// 支持 BlurHash 格式图片</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-blurhash:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=c1>// 支持通过 uri 或 placeholder、fallback、error 访问 compose resources 资源</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-compose-resources:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-extensions-compose-resources:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=c1>// 提供下载进度、图片类型角标、列表滚动中暂停加载、节省蜂窝流量等实用功能</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-extensions-compose:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-extensions-view:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=c1>// [仅 Android] 支持通过文件路径加载 apk 文件的图标 </span>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-extensions-apkicon:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=c1>// [仅 Android] 支持通过包名和版本号加载已安装 app 的图标</span>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-extensions-appicon:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=c1>// [仅 JVM] 支持使用 HttpURLConnection 访问网络图片</span>
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-http-hurl:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a>
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=c1>// [仅 JVM] 支持使用 OkHttp 访问网络图片</span>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-http-okhttp:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-35 name=__codelineno-2-35 href=#__codelineno-2-35></a>
<a id=__codelineno-2-36 name=__codelineno-2-36 href=#__codelineno-2-36></a><span class=c1>// 支持使用 2.x 版本的 ktor 访问网络图片</span>
<a id=__codelineno-2-37 name=__codelineno-2-37 href=#__codelineno-2-37></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-http-ktor2:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-38 name=__codelineno-2-38 href=#__codelineno-2-38></a>
<a id=__codelineno-2-39 name=__codelineno-2-39 href=#__codelineno-2-39></a><span class=c1>// 支持使用 3.x 版本的 ktor 访问网络图片</span>
<a id=__codelineno-2-40 name=__codelineno-2-40 href=#__codelineno-2-40></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-http-ktor3:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-41 name=__codelineno-2-41 href=#__codelineno-2-41></a>
<a id=__codelineno-2-42 name=__codelineno-2-42 href=#__codelineno-2-42></a><span class=c1>// 提供 koin 集成支持，代替 sketch-compose 和 sketch-view，默认从 koin 获取 Sketch 实例</span>
<a id=__codelineno-2-43 name=__codelineno-2-43 href=#__codelineno-2-43></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-compose-koin:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-44 name=__codelineno-2-44 href=#__codelineno-2-44></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-view-koin:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-45 name=__codelineno-2-45 href=#__codelineno-2-45></a>
<a id=__codelineno-2-46 name=__codelineno-2-46 href=#__codelineno-2-46></a><span class=c1>// 支持 SVG 图片</span>
<a id=__codelineno-2-47 name=__codelineno-2-47 href=#__codelineno-2-47></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-svg:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-48 name=__codelineno-2-48 href=#__codelineno-2-48></a>
<a id=__codelineno-2-49 name=__codelineno-2-49 href=#__codelineno-2-49></a><span class=c1>// [仅 Android] 使用 Android 内置的 MediaMetadataRetriever 类实现解码视频帧</span>
<a id=__codelineno-2-50 name=__codelineno-2-50 href=#__codelineno-2-50></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-video:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
<a id=__codelineno-2-51 name=__codelineno-2-51 href=#__codelineno-2-51></a>
<a id=__codelineno-2-52 name=__codelineno-2-52 href=#__codelineno-2-52></a><span class=c1>// [仅 Android] 使用 wseemann 的 FFmpegMediaMetadataRetriever 库实现解码视频帧</span>
<a id=__codelineno-2-53 name=__codelineno-2-53 href=#__codelineno-2-53></a><span class=n>implementation</span><span class=p>(</span><span class=s>&quot;io.github.panpf.sketch4:sketch-video-ffmpeg:</span><span class=si>${</span><span class=n>LAST_VERSION</span><span class=si>}</span><span class=s>&quot;</span><span class=p>)</span>
</code></pre></div> <blockquote> <p>[!TIP] * <code>sketch-compose</code>、<code>sketch-view</code> 模块都依赖 <code>sketch-singleton</code> &gt; 模块提供的单例，如果你不需要单例则可以直接依赖他们的 <code>*-core</code> 版本 * <code>sketch-http</code> 模块在 jvm 平台上依赖 <code>sketch-http-hurl</code>，在非 jvm 平台上依赖 <code>sketch-http-ktor3</code></p> </blockquote> <h3 id=_3>注册组件<a class=headerlink href=#_3 title="Permanent link">&para;</a></h3> <p>Sketch 支持自动发现并注册 Fetcher 和 Decoder 组件，在 jvm 平台通过 ServiceLoader 实现，在非 jvm 平台通过 @EagerInitialization 注解实现。</p> <p>自带模块全部支持自动注册，如果你想禁用自动注册，采用手动注册的方式请参考文档：<a href=register_component/ >《注册组件》</a></p> <h3 id=r8-proguard>R8 / Proguard<a class=headerlink href=#r8-proguard title="Permanent link">&para;</a></h3> <ol> <li>Android、iOS、Web 等平台不需要配置任何混淆规则</li> <li>桌面平台需要配置以下混淆规则： <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a># -------------------------- Sketch Privider ---------------------------- #
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>-keep class * implements com.github.panpf.sketch.util.DecoderProvider { *; }
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>-keep class * implements com.github.panpf.sketch.util.FetcherProvider { *; }
</code></pre></div></li> <li>可能还需要为间接依赖的 <a href=https://github.com/Kotlin/kotlinx.coroutines/blob/master/kotlinx-coroutines-core/jvm/resources/META-INF/proguard/coroutines.pro>Kotlin Coroutines</a>, <a href=https://square.github.io/okhttp/features/r8_proguard/ >OkHttp</a>, <a href=https://square.github.io/okio/ >Okio</a> 等三方库添加混淆配置</li> </ol> <h2 id=_4>快速上手<a class=headerlink href=#_4 title="Permanent link">&para;</a></h2> <h3 id=compose-multiplatform_1>Compose Multiplatform：<a class=headerlink href=#compose-multiplatform_1 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1>// val imageUri = &quot;/Users/my/Downloads/image.jpg&quot;</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=c1>// val imageUri = file:///compose_resource/composeResources/com.github.panpf.sketch.sample.resources/files/sample.png</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=kd>val</span><span class=w> </span><span class=nv>imageUri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;https://www.sample.com/image.jpg&quot;</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=n>AsyncImage</span><span class=p>(</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>    </span><span class=n>uri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>imageUri</span><span class=p>,</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>    </span><span class=n>contentDescription</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;photo&quot;</span>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=p>)</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a>
<a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=n>AsyncImage</span><span class=p>(</span>
<a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=w>    </span><span class=n>uri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>imageUri</span><span class=p>,</span>
<a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=w>    </span><span class=n>state</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rememberAsyncImageState</span><span class=p>(</span><span class=n>ComposableImageOptions</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=w>        </span><span class=n>placeholder</span><span class=p>(</span><span class=n>Res</span><span class=p>.</span><span class=na>drawable</span><span class=p>.</span><span class=na>placeholder</span><span class=p>)</span>
<a id=__codelineno-4-14 name=__codelineno-4-14 href=#__codelineno-4-14></a><span class=w>        </span><span class=n>error</span><span class=p>(</span><span class=n>Res</span><span class=p>.</span><span class=na>drawable</span><span class=p>.</span><span class=na>error</span><span class=p>)</span>
<a id=__codelineno-4-15 name=__codelineno-4-15 href=#__codelineno-4-15></a><span class=w>        </span><span class=n>crossfade</span><span class=p>()</span>
<a id=__codelineno-4-16 name=__codelineno-4-16 href=#__codelineno-4-16></a><span class=w>        </span><span class=c1>// There is a lot more...</span>
<a id=__codelineno-4-17 name=__codelineno-4-17 href=#__codelineno-4-17></a><span class=w>    </span><span class=p>}),</span>
<a id=__codelineno-4-18 name=__codelineno-4-18 href=#__codelineno-4-18></a><span class=w>    </span><span class=n>contentDescription</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;photo&quot;</span>
<a id=__codelineno-4-19 name=__codelineno-4-19 href=#__codelineno-4-19></a><span class=p>)</span>
<a id=__codelineno-4-20 name=__codelineno-4-20 href=#__codelineno-4-20></a>
<a id=__codelineno-4-21 name=__codelineno-4-21 href=#__codelineno-4-21></a><span class=n>AsyncImage</span><span class=p>(</span>
<a id=__codelineno-4-22 name=__codelineno-4-22 href=#__codelineno-4-22></a><span class=w>    </span><span class=n>rqeuest</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ComposableImageRequest</span><span class=p>(</span><span class=n>imageUri</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-23 name=__codelineno-4-23 href=#__codelineno-4-23></a><span class=w>        </span><span class=n>placeholder</span><span class=p>(</span><span class=n>Res</span><span class=p>.</span><span class=na>drawable</span><span class=p>.</span><span class=na>placeholder</span><span class=p>)</span>
<a id=__codelineno-4-24 name=__codelineno-4-24 href=#__codelineno-4-24></a><span class=w>        </span><span class=n>error</span><span class=p>(</span><span class=n>Res</span><span class=p>.</span><span class=na>drawable</span><span class=p>.</span><span class=na>error</span><span class=p>)</span>
<a id=__codelineno-4-25 name=__codelineno-4-25 href=#__codelineno-4-25></a><span class=w>        </span><span class=n>crossfade</span><span class=p>()</span>
<a id=__codelineno-4-26 name=__codelineno-4-26 href=#__codelineno-4-26></a><span class=w>        </span><span class=c1>// There is a lot more...</span>
<a id=__codelineno-4-27 name=__codelineno-4-27 href=#__codelineno-4-27></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-4-28 name=__codelineno-4-28 href=#__codelineno-4-28></a><span class=w>    </span><span class=n>contentDescription</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;photo&quot;</span>
<a id=__codelineno-4-29 name=__codelineno-4-29 href=#__codelineno-4-29></a><span class=p>)</span>
<a id=__codelineno-4-30 name=__codelineno-4-30 href=#__codelineno-4-30></a>
<a id=__codelineno-4-31 name=__codelineno-4-31 href=#__codelineno-4-31></a><span class=n>Image</span><span class=p>(</span>
<a id=__codelineno-4-32 name=__codelineno-4-32 href=#__codelineno-4-32></a><span class=w>    </span><span class=n>painter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rememberAsyncImagePainter</span><span class=p>(</span>
<a id=__codelineno-4-33 name=__codelineno-4-33 href=#__codelineno-4-33></a><span class=w>        </span><span class=n>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ComposableImageRequest</span><span class=p>(</span><span class=n>imageUri</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-4-34 name=__codelineno-4-34 href=#__codelineno-4-34></a><span class=w>            </span><span class=n>placeholder</span><span class=p>(</span><span class=n>Res</span><span class=p>.</span><span class=na>drawable</span><span class=p>.</span><span class=na>placeholder</span><span class=p>)</span>
<a id=__codelineno-4-35 name=__codelineno-4-35 href=#__codelineno-4-35></a><span class=w>            </span><span class=n>error</span><span class=p>(</span><span class=n>Res</span><span class=p>.</span><span class=na>drawable</span><span class=p>.</span><span class=na>error</span><span class=p>)</span>
<a id=__codelineno-4-36 name=__codelineno-4-36 href=#__codelineno-4-36></a><span class=w>            </span><span class=n>crossfade</span><span class=p>()</span>
<a id=__codelineno-4-37 name=__codelineno-4-37 href=#__codelineno-4-37></a><span class=w>            </span><span class=c1>// There is a lot more...</span>
<a id=__codelineno-4-38 name=__codelineno-4-38 href=#__codelineno-4-38></a><span class=w>        </span><span class=p>}</span>
<a id=__codelineno-4-39 name=__codelineno-4-39 href=#__codelineno-4-39></a><span class=w>    </span><span class=p>),</span>
<a id=__codelineno-4-40 name=__codelineno-4-40 href=#__codelineno-4-40></a><span class=w>    </span><span class=n>contentDescription</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;photo&quot;</span>
<a id=__codelineno-4-41 name=__codelineno-4-41 href=#__codelineno-4-41></a><span class=p>)</span>
</code></pre></div> <blockquote> <p>[!TIP] <code>placeholder(Res.drawable.placeholder)</code> 需要导入 <code>sketch-compose-resources</code> 模块</p> </blockquote> <h3 id=android-view_1>Android View：<a class=headerlink href=#android-view_1 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=c1>// val imageUri = &quot;/sdcard/download/image.jpg&quot;</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=c1>// val imageUri = &quot;file:///android_asset/image.jpg&quot;</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=c1>// val imageUri = &quot;content://media/external/images/media/88484&quot;</span>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=kd>val</span><span class=w> </span><span class=nv>imageUri</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;https://www.sample.com/image.jpg&quot;</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a><span class=n>imageView</span><span class=p>.</span><span class=na>loadImage</span><span class=p>(</span><span class=n>imageUri</span><span class=p>)</span>
<a id=__codelineno-5-7 name=__codelineno-5-7 href=#__codelineno-5-7></a>
<a id=__codelineno-5-8 name=__codelineno-5-8 href=#__codelineno-5-8></a><span class=n>imageView</span><span class=p>.</span><span class=na>loadImage</span><span class=p>(</span><span class=n>imageUri</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-9 name=__codelineno-5-9 href=#__codelineno-5-9></a><span class=w>    </span><span class=n>placeholder</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>drawable</span><span class=p>.</span><span class=na>placeholder</span><span class=p>)</span>
<a id=__codelineno-5-10 name=__codelineno-5-10 href=#__codelineno-5-10></a><span class=w>    </span><span class=n>error</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>drawable</span><span class=p>.</span><span class=na>error</span><span class=p>)</span>
<a id=__codelineno-5-11 name=__codelineno-5-11 href=#__codelineno-5-11></a><span class=w>    </span><span class=n>crossfade</span><span class=p>()</span>
<a id=__codelineno-5-12 name=__codelineno-5-12 href=#__codelineno-5-12></a><span class=w>    </span><span class=c1>// There is a lot more...</span>
<a id=__codelineno-5-13 name=__codelineno-5-13 href=#__codelineno-5-13></a><span class=p>}</span>
<a id=__codelineno-5-14 name=__codelineno-5-14 href=#__codelineno-5-14></a>
<a id=__codelineno-5-15 name=__codelineno-5-15 href=#__codelineno-5-15></a><span class=kd>val</span><span class=w> </span><span class=nv>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ImageRequest</span><span class=p>(</span><span class=n>context</span><span class=p>,</span><span class=w> </span><span class=n>imageUri</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-5-16 name=__codelineno-5-16 href=#__codelineno-5-16></a><span class=w>    </span><span class=n>placeholder</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>drawable</span><span class=p>.</span><span class=na>placeholder</span><span class=p>)</span>
<a id=__codelineno-5-17 name=__codelineno-5-17 href=#__codelineno-5-17></a><span class=w>    </span><span class=n>error</span><span class=p>(</span><span class=n>R</span><span class=p>.</span><span class=na>drawable</span><span class=p>.</span><span class=na>error</span><span class=p>)</span>
<a id=__codelineno-5-18 name=__codelineno-5-18 href=#__codelineno-5-18></a><span class=w>    </span><span class=n>crossfade</span><span class=p>()</span>
<a id=__codelineno-5-19 name=__codelineno-5-19 href=#__codelineno-5-19></a><span class=w>    </span><span class=n>target</span><span class=p>(</span><span class=n>imageView</span><span class=p>)</span>
<a id=__codelineno-5-20 name=__codelineno-5-20 href=#__codelineno-5-20></a><span class=w>    </span><span class=c1>// There is a lot more...</span>
<a id=__codelineno-5-21 name=__codelineno-5-21 href=#__codelineno-5-21></a><span class=p>}</span>
<a id=__codelineno-5-22 name=__codelineno-5-22 href=#__codelineno-5-22></a><span class=n>context</span><span class=p>.</span><span class=na>sketch</span><span class=p>.</span><span class=na>enqueue</span><span class=p>(</span><span class=n>request</span><span class=p>)</span>
</code></pre></div> <h2 id=_5>文档<a class=headerlink href=#_5 title="Permanent link">&para;</a></h2> <p>基础功能：</p> <ul> <li><a href=getting_started/ >开始使用</a></li> <li><a href=register_component/ >注册组件</a></li> <li><a href=compose/ >Compose</a></li> <li><a href=http/ >Http：加载网络图片</a></li> <li><a href=animated_image/ >AnimatedImage：GIF、WEBP、HEIF</a></li> <li><a href=resize/ >Resize：修改图片尺寸</a></li> <li><a href=transformation/ >Transformation：转换图片</a></li> <li><a href=transition/ >Transition：用炫酷的过渡方式显示图片</a></li> <li><a href=state_image/ >StateImage：占位图和错误图</a></li> <li><a href=listener/ >Listener：监听请求状态和下载进度</a></li> <li><a href=download_cache/ >DownloadCache：了解下载缓存，避免重复下载</a></li> <li><a href=result_cache/ >ResultCache：了解结果缓存，避免重复转换</a></li> <li><a href=memory_cache/ >MemoryCache：了解内存缓存，避免重复加载</a></li> <li><a href=fetcher/ >Fetcher：了解 Fetcher 及扩展新的 URI 类型</a></li> <li><a href=decoder/ >Decoder：了解 Sketch 的解码过程</a></li> <li><a href=target/ >Target：将加载结果应用到目标上</a></li> <li><a href=svg/ >SVG：解码 SVG 静态图片</a></li> <li><a href=video_frame/ >VideoFrames：解码视频帧</a></li> <li><a href=blurhash/ >BlurHash</a></li> <li><a href=exif_orientation/ >ExifOrientation：纠正图片方向</a></li> <li><a href=image_options/ >ImageOptions：统一管理图片配置</a></li> <li><a href=request_interceptor/ >RequestInterceptor：拦截 ImageRequest</a></li> <li><a href=decode_interceptor/ >DecodeInterceptor：拦截解码过程</a></li> <li><a href=preload/ >预加载图片到内存中</a></li> <li><a href=download_image/ >下载图片</a></li> <li><a href=lifecycle/ >Lifecycle</a></li> <li><a href=log/ >日志</a></li> <li><a href=migrate/ >迁移</a></li> </ul> <p>特色功能：</p> <ul> <li><a href=sketch_image_view/ >SketchImageView：通过 XML 属性配置请求</a></li> <li><a href=long_image_grid_thumbnails/ >提高长图在网格列表中的清晰度</a></li> <li><a href=progress_indicator/ >显示下载进度</a></li> <li><a href=mime_type_logo/ >显示图片类型角标</a></li> <li><a href=save_cellular_traffic/ >蜂窝数据网络下暂停下载图片节省流量</a></li> <li><a href=pause_load_when_scrolling/ >列表滑动中暂停加载图片</a></li> <li><a href=apk_app_icon/ >显示 APK 文件或已安装 APP 的图标</a></li> </ul> <h2 id=_6>更新日志<a class=headerlink href=#_6 title="Permanent link">&para;</a></h2> <p>请查看 <a href=CHANGELOG/ >CHANGELOG.md</a> 文件</p> <h2 id=_7>测试平台<a class=headerlink href=#_7 title="Permanent link">&para;</a></h2> <ul> <li>Android: Emulator; Arm64; API 21-34</li> <li>Desktop: macOS; 14.6.1; JDK 17</li> <li>iOS: iphone 16 simulator; iOS 18.1</li> <li>Web: Chrome; 130</li> </ul> <h2 id=app_1>运行示例 App<a class=headerlink href=#app_1 title="Permanent link">&para;</a></h2> <p>准备环境：</p> <ol> <li>Android Studio: Norwhal+ (2025.1.1+)</li> <li>JDK: 17+</li> <li>使用 <a href=https://github.com/Kotlin/kdoctor>kdoctor</a> 检查运行环境，并按照提示安装需要的软件</li> <li>Android Studio 安装 <code>Kotlin Multiplatform</code> 插件</li> </ol> <p>运行示例 App：</p> <ol> <li>克隆项目并使用 Android Studio 打开</li> <li>同步完成后 <code>Kotlin Multiplatform</code> 插件会自动为各个平台创建运行配置</li> <li>选择对应平台的运行配置，然后点击运行即可</li> </ol> <h2 id=40>关于 4.0 版本<a class=headerlink href=#40 title="Permanent link">&para;</a></h2> <ul> <li>maven groupId 升级为 <code>io.github.panpf.sketch4</code>，因此 2.*、3.* 版本不会提示升级</li> <li>4.0 版本专为 Compose Multiplatform 打造，所以 API 有很多破坏性改动，请谨慎升级</li> <li>4.0 版本做了大量的简化，比 3.0 版本简单很多，详情请查看更新日志</li> <li>Android 最低 API 升到了 API 21</li> <li>Kotlin 版本升级到了 2.0.0</li> </ul> <h2 id=_8>特别感谢<a class=headerlink href=#_8 title="Permanent link">&para;</a></h2> <ul> <li><a href=https://github.com/coil-kt/coil>coil-kt/coil</a>: Sketch 使用了来自 Coil 的部分代码，包括 framework、compose 以及 sketch-animated 的 movie 部分</li> <li><a href=https://github.com/koral--/android-gif-drawable>koral--/android-gif-drawable</a>: https://github.com/panpf/sketch/blob/main/sketch-animated-koralgif</li> <li><a href=https://github.com/wseemann/FFmpegMediaMetadataRetriever>wseemann/FFmpegMediaMetadataRetriever</a>: https://github.com/panpf/sketch/blob/main/sketch-video-ffmpeg</li> <li><a href=https://github.com/BigBadaboom/androidsvg>BigBadaboom/androidsvg</a>: https://github.com/panpf/sketch/blob/main/sketch-svg</li> </ul> <h2 id=_9>我的项目<a class=headerlink href=#_9 title="Permanent link">&para;</a></h2> <p>以下是我的其它开源项目，感兴趣的可以了解一下：</p> <ul> <li><a href=https://github.com/panpf/zoomimage>zoomimage</a>：用于缩放图片的库，支持 Compose Multiplatform 和 Android View；支持双击缩放、单指或双指手势缩放、单指拖动、惯性滑动、定位、旋转、超大图子采样等功能。</li> <li><a href=https://github.com/panpf/assembly-adapter>assembly-adapter</a>：Android 上的一个为各种 Adapter 提供多类型 Item 实现的库。还顺带为 RecyclerView 提供了最强大的 divider。</li> <li><a href=https://github.com/panpf/stickyitemdecoration>sticky-item-decoration</a>：RecyclerView 黏性 item 实现</li> </ul> <h2 id=license>License<a class=headerlink href=#license title="Permanent link">&para;</a></h2> <p>Apache 2.0. 有关详细信息，请参阅 <a href=https://github.com/panpf/sketch/blob/main/LICENSE.txt>LICENSE</a> 文件.</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=页脚> <a href=getting_started/ class="md-footer__link md-footer__link--next" aria-label="下一页: Getting Started"> <div class=md-footer__title> <span class=md-footer__direction> 下一页 </span> <div class=md-ellipsis> Getting Started </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2024 panpf </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/panpf/sketch target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill=currentColor d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.tabs", "content.code.annotate", "content.code.copy", "navigation.indexes", "navigation.sections", "navigation.expand", "navigation.footer", "navigation.instant", "navigation.tracking", "search.highlight", "search.suggest", "search.share"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script> <script src=../assets/javascripts/bundle.50899def.min.js></script> </body> </html>